<html>
<head>
<script src="Notation.js"></script>
<script src="RuleInput.js"></script>
<script src="DesignView.js"></script>
<script src="PreView.js"></script>
<script>

var design;
var preview0;
var preview1;
var preview2;
var preview3;
var ruleInput0;

    window.requestAnimFrame = (function(){
      return  window.requestAnimationFrame       || 
              window.webkitRequestAnimationFrame || 
              window.mozRequestAnimationFrame    || 
              window.oRequestAnimationFrame      || 
              window.msRequestAnimationFrame     || 
              function( callback ){
                window.setTimeout(callback, 1000 / 60);
              };
    })();

function onLoad() {
	var vertices = [];
	vertices.push(new Vertice(50, 20));
	vertices.push(new Vertice(150, 30));
	vertices.push(new Vertice(150, 130));
	vertices.push(new Vertice(70, 10));

	var lines = [];
	lines.push(new Line(vertices[0], vertices[1]));
	lines.push(new Line(vertices[1], vertices[2]));
	lines.push(new Line(vertices[1], vertices[3]));
	
	var system = new System();
/*	// Dragon
	// AX
	system.setAxiom([Tokens.Z, Tokens.X]);
	// X=X+YA+
	system.setRule(Tokens.X, [
		Tokens.X,
		Tokens.LEFT,
		Tokens.Y,
		Tokens.Z,
		Tokens.RIGHT
	]);
	// Y=-AX-Y
	system.setRule(Tokens.Y, [
		Tokens.RIGHT,
		Tokens.Z,
		Tokens.X,
		Tokens.RIGHT,
		Tokens.Y
	]);
*/
/**/
	// F
	system.setAxiom([Tokens.X]);
	// F+F-F-F+F
	system.setRule(Tokens.X, [
		Tokens.X,
		Tokens.LEFT,
		Tokens.X,
		Tokens.RIGHT,
		Tokens.X,
		Tokens.RIGHT,
		Tokens.X,
		Tokens.LEFT,
		Tokens.X
	]);
/**/

	design = new DesignView(document.getElementById("design"), vertices, lines, system);
	vertices = new Array();
	lines = new Array();
	preview0 = new PreView(document.getElementById("preview0"), system, 0);
	preview1 = new PreView(document.getElementById("preview1"), system, 1);
	preview2 = new PreView(document.getElementById("preview2"), system, 4);
	preview3 = new PreView(document.getElementById("preview3"), system, 8);
	ruleInput0 = new RuleInput(document.getElementById("rule0"), system);

	frame();
}

function frame() {
	requestAnimFrame(frame);
	
	design.frame();
	preview0.frame();
	preview1.frame();
	preview2.frame();
	preview3.frame();
	ruleInput0.frame();
}

</script>
</head>
<body onLoad="onLoad()">
<p>
<canvas id="design" width="200" height="200" style="border:1px solid #aaaaaa;"></canvas>
<label for="rule0">X = <input id="rule0" type="text" size="20"></input></label>
</p>
<p>
<canvas id="preview0" width="100" height="100" style="border:1px solid #aaaaaa;"></canvas>
<canvas id="preview1" width="150" height="150" style="border:1px solid #aaaaaa;"></canvas>
<canvas id="preview2" width="200" height="200" style="border:1px solid #aaaaaa;"></canvas>
<canvas id="preview3" width="250" height="250" style="border:1px solid #aaaaaa;"></canvas>
</p>

</body>
</html>